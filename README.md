# MIAD_G1_Perfil_riesgo_establecimientos_de_credito

Repositorio git para el proyecto "Perfil de riesgo de los establecimientos de crédito" del grupo 1 aprendizaje no supervisado de la Maestría en inteligencia analítica de datos para la toma de decisiones MIAD Universidad de los Andes Colombia. Agosto 2023.

## Resumen: 

En estos tiempos de incertidumbre económica, y ante el cierre de entidades financieras de alto renombre mundial, se hace necesario, tanto para entidades públicas como para grandes inversionistas privados, encontrar metodologías de alta eficiencia y fácil ejecución en poco tiempo para  poder determinar el perfil de riesgo de las entidades bancarias de Colombia. En el siguiente proyecto, sugerimos un acercamiento mediante técnicas de aprendizaje no supervisado, específicamente de clustering, y de reducción de dimensionalidad, que permitan generar perfiles de riesgo con el fin de tomar las mejores decisiones de inversión y de salvamento según sea necesario, y que tengan la capacidad de adaptarse fácilmente al fluctuante escenario económico de nuestros tiempos.

## Introduccion: 

La supervisión bancaria, como señalan Hotori, et. al. (2022), corresponde a una necesidad del sistema financiero actual, como una respuesta al control que requieren las entidades públicas ante fenómenos como la información asimétrica que se posee sobre el mercado entre entidades financieras públicas y privadas, la constante fluctuación de externalidades y los riesgos de la economía moderna.  Incluso, entidades de alto reconocimiento a nivel mundial como Credit Suisse (Portafolio, 2022)  o Silicon Valley Bank (SVB) (Ferguson, 2023), que recientemente tuvieron que declararse en bancarrota debido a la falta de supervisión en tiempo real, hacen prioritario realizar la pregunta: ¿Cúal es una posible metodología que permita realizar una categorización y análisis del riesgo de las distintas entidades financieras de un país, en este caso particular de Colombia?

Este tipo de análisis resulta de interés para dos grupos:

- Entidades de supervisión bancaria en Colombia: Si bien, como señalan Estrada y Gutierrez (2009), la labor de supervisión bancaria en Colombia por parte del Banco de la República, así como de la Superintendencia Financiera de Colombia (SFC), ha resultado satisfactoria en el control de crisis y monitoreo periódico de las entidades bancarias, resulta necesario establecer criterios de medición que permitan tomar decisiones ante cambios súbitos y que sean de construcción e implementación más acelerada.

- Inversionistas extranjeros: Autores como Kandrac y Schlusche (2017) evidencian que, en escenarios donde la supervisión bancaria es mucho menor, era mayor la incidencia de pérdidas significativas en la inversión. Si bien la volatilidad del mercado extranjero y el score de riesgo de Colombia ha ido en aumento, un sistema eficaz de supervisión bancaria brinda confianza a los inversionistas.

Como es tradicional en los perfiles de riesgo, no se cuenta con categorías o definiciones fijas de los perfiles de riesgo, por lo que modelos de aprendizaje supervisado no se consideran como una respuesta al problema propuesto. Para este caso particular se considerará como un problema de clasificación no supervisada, por lo que se revisarán a detalle algoritmos de clustering. También, de ser necesario, se revisará la necesidad de reducción de dimensionalidad.

## Antecedentes bibliográficos

A nivel internacional, la revisión realizada por Guerra y Castelli (2021) brinda el mayor acercamiento al uso de machine learning para la supervisión bancaria. Llama la atención observar el volumen de trabajos que utilizan un enfoque supervisado para la predicción de los perfiles de riesgo (De una revisión de 41 papers publicados entre el 2000 y el 2021, únicamente 1 hace uso de técnicas de aprendizaje no supervisado)

Entre las técnicas más utilizadas se encuentra el uso de bagging y boosting, así como redes neuronales, para la determinación de perfiles de riesgo. El estudio más referenciado por bibliografía académica (y también el único que emplea técnicas de aprendizaje no supervisadio), dentro de los revisados por Guerra y Castelli (2021), es el realizado por Boyacioglu et. al (2009), en el cual revisa diferentes metodologías de machine learning que permitieran identificar bancos que estuvieran en riesgo de una posible bancarrota. Dentro de las metodologías analizadas se utilizó el algoritmo de k-medias, sin embargo no obtuvo un desempeño superior frente a metodologías más robustas. En este caso, los métodos propuestos no permiten solucionar el problema ya que no se ha llegado a la bancarrota (A diferencia de estos estudios que tomaron información de bancos que ya habían quebrado anteriormente), y no se tiene una única variable de respuesta, por lo que el aprendizaje no supervisado sigue siendo la metodología recomendada.

Dentro de los estudios realizados con aprendizaje no supervisado más relevantes para resolver la pregunta de interés, se encuentra el estudio de Lee, Booth y Alam (2005), en el cual compara redes neuronales artificiales tanto supervisadas como no supervisadas (denominadas redes Kohonen) para la predicción de bancarrota de entidades financieras en Corea. De dicho estudio es posible concluir que, si bien las redes no supervisadas no poseen el mismo poder predictivo que aquellas que utilizan aprendizaje supervisado, permiten realizar predicciones en un tiempo más cercano, además que permite evaluar casi en tiempo real tanto la evolución de la entidad como de sus alrededores para tomar decisiones.

Finalmente, la revisión de literatura colombiana sobre el tema suele estar centrada en perfiles de riesgo para los clientes del banco (Como el realizado por Giraldo y Marín (2021) acerca de machine learning para riesgo de crédito), pero no para clasificar los bancos en niveles de riesgo, por lo que esta investigación supone un pivote académico para incentivar la profundización en el uso de machine learning para perfilar el riesgo de bancos colombianos.

## Propuesta metodológica

En Colombia existe la Red de Seguridad del Sistema Financiero, conformada por entidades como la Superintendencia Financiera, el Banco de la República, Ministerio de Hacienda y Fogafín, la cual se encarga de monitorear al sistema financiero, dentro de éste a los bancos, con el fin de identificar posibles riesgos y vulnerabilidades que podrían tener algún efecto sobre la estabilidad financiera de la economía colombiana. Sobre todo, en una coyuntura económica como la actual, de desaceleración económica, condiciones financieras más restrictivas y una inflación elevada, el monitoreo de indicadores financieros de las entidades por parte de la Red cobra mayor relevancia. Así mismo después de la crisis financiera del 2008, los agentes reguladores a nivel global se han interesado en desarrollar herramientas que les permitan monitorear los riesgos financieros. En este documento proponemos calcular una medida de riesgo para los bancos colombianos que recoja el comportamiento de los indicadores mencionados en la sección anterior y que contribuya a la labor de supervisión que realiza la Red. Para ello se utilizará la metodología de componentes principales que permite la reducción de la dimensionalidad de los datos y el indicador sería el primer componente principal el cual explica la mayor varianza de los datos. Así mismo, esta metodología permite conocer el peso que tiene cada variable sobre el componente principal a partir de los loadings.
 
Por otro lado, se realizará un análisis de clústeres para identificar aquellos bancos que tienen perfiles de riesgo similares para que la Red supervise en mayor medida aquellos clústeres con mayor riesgo evitando posibles futuras quiebras de bancos o contagio sobre el resto del sistema financiero. Existen distintos métodos de clustering como k-medias, k-medoides o clustering jerárquico. Una de las ventajas de este último frente a los primeros es que no se necesita definir a priori el número de clústeres a calcular y es la metodología que se usa en la literatura revisada. Sin embargo, en este documento se probarán distintos métodos y a partir de los resultados se seleccionará el que genere los mejores resultados.

## Resultados

### 1.	Cálculo Indicador de riesgo mediante componentes principales

Como se mencionó anteriormente se propone calcular un indicador de riesgo para las entidades bancarias. En este caso, se hace uso de componentes principales para reducir la dimensionalidad de las variables sobre salud financiera y se selecciona el primer componente principal que es capaz de explicar del 41.5% de la variabilidad de los datos. Al usar componentes principales encontramos algunas ventajas, por un lado, podemos ver la variabilidad del indicador a lo largo del tiempo y a partir de los loadings podemos conocer cuál variable tiene mayor relevancia dentro del indicador.

En la figura 2 se presenta el indicador de riesgo desagregado por el peso que tiene cada variable para el mes de mayo. Entre más alto sea este indicador más riesgoso es la entidad. En general vemos que a pesar de la coyuntura actual el sistema financiero colombiano se mantiene sólido. El G4 conformado por los cuatro principales bancos del país (Bancolombia, Banco de Bogotá, Davivienda y BBVA) mantienen valores negativos y son muy similares entre ellos. Por otro lado, vemos que las tres entidades bancarias con mayor riesgo son Banco Pichincha, Banco Falabella y Banco Unión. En cuanto al primer banco, en el mes de marzo la calificadora de riesgo Fitch redujo su calificación dada la profundización de las pérdidas operativas, niveles menores de capitalización y deterioros en la calidad de activos. Lo anterior debido a la decisión del banco de reformular su modelo de negocio y acelerar su transformación digital. Por el lado de Banco Falabella se observa que es una entidad que tiene una fuerte concentración en crédito de consumo, específicamente en tarjetas de crédito y en un contexto de altas tasas de interés más desaceleración económica se ha visto afectada por un aumento en los niveles de morosidad. Por último, tenemos Banco Unión que anteriormente era una compañía de financiamiento y también se encuentra en un proceso de transición al convertirse en banco. La característica común entre estas entidades es que tienen un componente de cartera sobre activos elevado, es decir son entidades con una alta exposición a riesgo crediticio que se han visto afectadas por el aumento en la morosidad. 

### 2.	Identificación de clusters 

En un primer intento se utiliza k-medias y k-medoides sobre las 9 variables seleccionadas y con el método del codo se seleccionan 3 clusters, sin embargo, vemos que la asignación de las entidades a estos clusters presenta problemas. Por ende, se decide usar los métodos de clusterización sobre los tres primeros componentes principales que explican cerca del 81.5% de la variación de los datos. Con componentes principales, se observa una mejora frente a cuando se realiza con las 9 variables iniciales como se observa en los gráficos a continuación y entre k-medias y k-medoides se observa una mejor clasificación en el primero. La caracterización de clusters por cada uno de los métodos puede verse en la figura 3. Cuando se utiliza k-medias sobre los tres componentes, las entidades menos riesgosas quedan agrupadas en el primer cluster mientras que la mayoría de las entidades (inclusive las más riesgosas) quedan clasificadas en el cluster 2 y la más riesgosa que es pichincha queda en el 3. Sin embargo, utilizando k-medias y k-medoides vemos que la clasificación no es del todo perfecta y por esta razón realizamos otro intento con cluster jerárquico. Los resultados de este cluster se pueden ver en la figura 4. Al realizar el ejercicio de clusterización con los datos estandarizados, por el método de clúster jerárquico se evaluaron los diferentes métodos de enlace entre los puntos, Se evidencio que en algunos casos se genera una superposición de los datos de los clusters lo cual no permite un análisis claro de las agrupaciones generadas, en este ejercicio el modelo con el mejor score de Silhouette corresponde a al modelo con enlace tipo single con un score de 0.56 generando 4 grupos diferentes. posteriormente se realizó el ejercicio de clusterización con una reducción de la dimensionalidad por medio de PCA de igual manera evaluando los diferentes métodos de enlace entre los puntos, Comparando estos resultados con los obtenidos antes de realizar PCA se evidencia una mejora significativa en la generación de las agrupaciones, siendo inclusive evidente al ojo humano las diferentes agrupaciones generadas, lo cual permite un análisis más claro de las agrupaciones, en este ejercicio el modelo con el mejor score de Silhouette corresponde a al modelo con enlace tipo “average” y “centroid” para los cuales se obtuvo un score de 0.601, en la gráfica de este método se observa cómo al reducir la dimensionalidad, las observaciones que para este caso son cada una de las entidades financieras se segmentan de tal manera que forman 5 grupos y esto con respecto al perfil de riesgo financiero que se pretende analizar puede ser muy diciente ya que según los valores de los 2 primeros componentes mostrados en la gráfica y teniendo en cuenta que entre más alto es el indicador más riesgosa es la entidad se pueden ver los grupos de entidades muy riesgosas , poco riesgosas, sólidas, etc en cuanto a riesgo financiero. 

## Conclusiones y trabajo futuro 

El uso de reducción de dimensionalidad permite realizar una calificación preliminar de las distintas entidades financieras, permitiendo realizar un perfilamiento y además permitiendo una mejor segmentación al momento de realizar grupos (clusters) De los algoritmos utilizados, el algoritmo de clustering jerárquico permitió identificar con mayor claridad los distintos grupos por nivel de riesgo. Esto sumado a la poca capacidad computacional que requiere, lo convierte en el método ideal para plantear una solución analítica de fácil implementación En posteriores etapas se sugiere incrementar el número de variables que contribuya a construir componentes loadings más robustos, así como la incorporación de información histórica, para ver una evolución del riesgo a lo largo del tiempo y también poder determinar comportamientos o perfiles atípicos con mayor precisión.


## Integrantes: 
- Laura Becerra
- Cesar Porras
- Diego Monroy
- Robert Lopez
